class Solution:
    def maxArea(self, mat):
        # Helper function to find largest rectangle in histogram
        def rectangle(heights):
            stack = []
            max_area = 0
            heights.append(0)  # sentinel
            for i, h in enumerate(heights):
                while stack and heights[stack[-1]] > h:
                    height = heights[stack.pop()]
                    width = i if not stack else i - stack[-1] - 1
                    max_area = max(max_area, height * width)
                stack.append(i)
            heights.pop()  # remove sentinel AFTER processing
            return max_area

        if not mat:
            return 0

        r, c = len(mat), len(mat[0])
        Area = 0
        heightf = [0] * c

        for i in range(r):
            for j in range(c):
                if mat[i][j] == 0:
                    heightf[j] = 0
                else:
                    heightf[j] += 1
            Area = max(Area, rectangle(heightf))

        return Area
